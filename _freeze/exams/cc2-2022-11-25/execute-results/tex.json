{
  "hash": "b057cf01ad6aed937e9c2bd2f3bcbfa0",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat:\n  pdf:\n    code-annotations: below\n    code-fold: false\n    toc: false\n    output-file: cc2-2022-11-25.pdf\n    include-in-header:\n      - text: \"\\\\lhead{{\\\\sf  Base de données (BD5) \\\\\\\\ CC 2 2022-11-25  16h30-17h45}}\"\n  html:\n    standalone: true\n    code-fold: true\n    output-file: cc2-2022-11-25.html\nparams:\n    year: 2022 \n    curriculum: \"L3 MIASHS/Ingémath\"\n    university: \"Université Paris Cité\"\n    homepage: \"https://stephane-v-boucheron.fr/courses/bdd\"\n    moodle: \"https://moodle.u-paris.fr/course/view.php?id=2313\"\n---\n\n\n\n\n\n\n\n::: {layout=\"[80,20]\"}\n\n::: {#first-column}\n\n\n\n- **L3 MIASHS/Ingémath**\n- **[Université Paris Cité](https://www.u-paris.fr)**\n- Année 2022-2023\n- [Course Homepage](https://stephane-v-boucheron.fr/courses/bdd)  \n- [Moodle](https://moodle.u-paris.fr/course/view.php?id=2313)\n\n::: \n\n::: {#second-column}\n![](/images/UniversiteParis_monogramme_couleur_RVB.png){align=\"right\" style=\"size:50px;\" width=75}\n:::\n\n:::\n\n\nSur le serveur `bd_2023` hébergé par `etu-pgsql`, dans votre schéma personnel, créer les vues correspondant aux cinq questions suivantes.\n\n---\n\n**Question 1**\n\nSchéma `nycflights13`\n\nCréer dans votre schéma personnel une vue nommée `cc2_vue_1`\nde schéma `(n integer)` qui répond à la question : combien de vols sont arrivés avec un retard d'au moins une heure en partant à l'heure de l'aéroport `JFK` ?\n\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"solution\"}\n```{.sql}\nCREATE OR REPLACE MATERIALZED VIEW foobar42.v_1 AS (\nWITH A as (\n    SELECT * FROM nycflights13.flights AS f\n    WHERE f.origin = 'JFK'\n    AND f.arr_delay >= 60\n    AND f.dep_delay <= 0\n) SELECT COUNT(*)::integer AS n\nFROM A \n);\n```\n:::\n:::\n\n---\n\n**Question 2**\n\nSchéma `nycflights13`\n\n\nCréer dans votre schéma personnel une vue nommée `cc2_vue_2`\nde schéma `(n integer)` qui répond à la question :  Combien de modèles différents ont été faits par la compagnie `BOEING` ? \n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"solution\"}\n```{.sql}\nCREATE OR REPLACE VIEW cc2_vue_2 AS (\nSELECT COUNT(distinct model)::integer  AS N\nFROM nycflights13.planes\nGROUP BY manufacturer\nHAVING manufacturer = 'BOEING'\n);\n```\n:::\n:::\n\n\n\n---\n\n**Question 3**\n\nSchéma `babynames`\n\nCréer dans votre schéma personnel une vue nommée `cc2_vue_3`\nde schéma  `(prenom TEXT)`  qui répond à la question : \n\nQuels sont les prénoms donnés durant toutes les décennies pour lesquelles la base de données comporte des informations, sans doublon, par ordre alphabétique. \n\n844 lignes attendues (dont `_PRENOMS_RARES`)\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"solution\"}\n```{.sql}\nWITH decennie AS (\n    SELECT COUNT(DISTINCT annee/10) AS nb F\n    ROM bebes)\nSELECT DISTINCT prenom \nFROM bebes \nGROUP BY prenom \nHAVING COUNT(DISTINCT annee/10)=(SELECT nb FROM decennie) \nORDER BY prenom ;\n```\n:::\n:::\n\n\n---\n\n**Question 4**\n\nSchéma ou `babynames`\n\nCréer dans votre schéma personnel une vue nommée `cc2_vue_4`\nde schéma  `(prenom, n_feminin, n_masculin)`  qui contient \nles prénoms *mixtes*, c'est-à-dire les prénoms attribués plus de \n5000 fois à des filles et à des garcons (`MARIE` a été attribué\n`26897` fois à des petits garcons). `n_feminin` représente le nombre \ntotal d'attributions du prénom à des filles et `n_masculin` représente \nle nombre total d'attributions du prénom à des garcons. \n\nVotre vue contiendra (entre autres) la ligne :\n\n```\n+---------+---------+----------+\n|prenom   |n_feminin|n_masculin|\n+---------+---------+----------+\n| ...     | ...     | ...      |\n|MARIE    |  2232238|     26897|\n| ...     | ...     | ...      |\n| ...     | ...     | ...      |\n```\n\n\n\n---\n\n**Question 5**\n\nSchéma `nycflights13`\n\nCréer dans votre schéma personnel une vue nommée `cc2_vue_5`\nde schéma  `(name text)`  qui répond à la question : Quelles sont les noms des destinations accessibles par un vol direct depuis toutes les origines ?\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.callout-tip title=\"solution\"}\n```{.sql}\nWITH r AS (\n\tSELECT f.dest\n\tFROM nycflights13.flights f   \n\tGROUP BY f.dest \n\tHAVING COUNT(DISTINCT f.origin) >= ALL \n      (SELECT COUNT(DISTINCT f2.origin) \n       FROM nycflights13.flights f2 )\n)\nSELECT a.\"name\"::text \nFROM nycflights13.airports a JOIN r ON (a.faa = r.dest) ;\n```\n:::\n:::\n\n```\n42 lignes attendues\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}